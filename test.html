<!DOCTYPE html>
<html>
  <head>
    <title>SurveyJS Form</title>
    <script src="https://unpkg.com/survey-core@1.9.23/survey.core.min.js"></script>
    <script src="https://unpkg.com/survey-knockout-ui@1.9.23/survey-knockout-ui.min.js"></script>
    <script src="https://unpkg.com/survey-json@1.9.23/survey-json.min.js"></script>
  </head>
  <body>
    <div id="surveyContainer"></div>

    <script>
      // Load JSON from testing.json
      fetch("testing.json")
        .then((response) => response.json())
        .then((surveyJson) => {
          const survey = new Survey.Model(surveyJson);
          survey.onComplete.add(function (sender) {
            const surveyData = sender.data;

            fetch("https://h.albato.com/wh/38/1lfn9r8/rcpnt76nkGOOjpAL2frbazJAMn_eJfuWTo179pi9AjE/", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(surveyData),
            })
              .then((response) => {
                if (!response.ok) {
                  throw new Error("Failed to send webhook");
                }
                alert("Form submitted and webhook sent!");
              })
              .catch((error) => {
                alert("Webhook error: " + error.message);
              });
          });

          Survey.KnockoutSurveyUI.render("surveyContainer", { model: survey });
        });
    </script>
  </body>
</html>
